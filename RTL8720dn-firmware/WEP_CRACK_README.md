# WEP破解功能使用说明

## 功能概述

WEP（Wired Equivalent Privacy）破解功能是delfyRTL项目的重要扩展，可以捕获WEP加密网络的IV（初始化向量）数据包，并通过多种方法尝试破解WEP密钥。

## 技术原理

### WEP加密机制
WEP使用RC4流密码算法进行加密：

1. **密钥构造**：WEP密钥 + IV（初始化向量）
2. **加密过程**：RC4(IV + WEP密钥) XOR 明文数据
3. **数据包结构**：IV(3字节) + KeyID(1字节) + 加密数据 + ICV(4字节)

### WEP安全弱点
WEP存在多个严重的安全漏洞：

1. **IV重用**：24位IV空间太小，容易重复使用
2. **弱IV**：某些IV值可以用于密钥恢复
3. **统计攻击**：通过大量IV数据可以统计分析出密钥
4. **密钥管理**：密钥更新机制不完善

### 破解方法
本实现支持多种WEP破解方法：

1. **弱IV攻击**：利用已知的弱IV模式恢复密钥
2. **统计攻击**：通过大量IV数据进行统计分析
3. **暴力破解**：尝试所有可能的密钥组合
4. **字典攻击**：使用常见密码字典

## 使用方法

### 1. 固件命令

通过UART发送以下命令控制WEP破解：

#### 启动WEP破解
```
WEP:ON
```

#### 停止WEP破解
```
WEP:OFF
```

#### 查看状态
```
WEP:STAT
```
返回格式：
```
WEP:STAT|TOTAL:2|ACTIVE:1|CRACKED:0|ACTIVE:YES
```

#### 导出数据
```
WEP:EXPORT
```

#### 清除数据
```
WEP:CLEAR
```

### 2. Flipper Zero界面

在主菜单中选择"WEP Crack"选项：
- **Start**: 开始/停止WEP破解
- **Status**: 查看破解状态
- **Export**: 导出WEP数据
- **Clear**: 清除WEP数据

## 数据格式

### WEP数据格式
```
WEP:AP:AA:BB:CC:DD:EE:FF|CLIENT:11:22:33:44:55:66|SSID:TestNetwork|CHANNEL:6|KEY_LENGTH:128|IV_COUNT:50000|UNIQUE_IV:45000|CRACKED:YES|KEY:12:34:56:78:9A:BC:DE:F0:11:22:33:44:55|CRACK_TIME:1234567890|TIME:1234567890
WEP_IVS:12:34:56,78:9A:BC,DE:F0:11,22:33:44,55:66:77,88:99:AA,BB:CC:DD,EE:FF:00,11:22:33,44:55:66
```

### 字段说明
- **AP**: 接入点的MAC地址
- **CLIENT**: 客户端的MAC地址
- **SSID**: 网络名称
- **CHANNEL**: WiFi信道
- **KEY_LENGTH**: 密钥长度（64/128/152/256位）
- **IV_COUNT**: 收集的IV总数
- **UNIQUE_IV**: 唯一IV数量
- **CRACKED**: 是否已破解
- **KEY**: 破解的密钥（十六进制）
- **CRACK_TIME**: 破解时间戳
- **TIME**: 开始时间戳

## 技术实现

### 核心文件
- `wifi_wep_crack.h` - 头文件定义
- `wifi_wep_crack.cpp` - 核心实现
- `wifi_cust_tx.h/cpp` - WiFi帧处理扩展
- `RTL8720dn-firmware.ino` - 主固件集成

### 关键函数
- `process_wep_packet()` - 处理WEP数据包
- `extract_wep_data()` - 提取WEP数据
- `crack_wep_key()` - 破解WEP密钥
- `analyze_wep_weakness()` - 分析WEP弱点

### 数据结构
```cpp
typedef struct {
    uint8_t ap_mac[6];           // AP的MAC地址
    uint8_t client_mac[6];       // 客户端的MAC地址
    uint8_t iv[3];               // 初始化向量
    uint8_t key_id;              // 密钥ID
    uint8_t encrypted_data[256]; // 加密数据
    uint16_t data_length;        // 数据长度
    uint32_t timestamp;          // 时间戳
    bool is_valid;               // 数据是否有效
} WEPPacket;
```

## 使用场景

### 1. 渗透测试
- 测试WEP网络的安全性
- 验证WEP加密的脆弱性
- 教育目的的安全演示

### 2. 安全研究
- 研究WEP加密算法
- 分析IV重用问题
- 开发新的攻击技术

### 3. 网络诊断
- 分析老旧网络设备
- 识别WEP加密网络
- 评估网络安全风险

## 破解成功率

### 影响因素
1. **IV数量**：需要收集足够的IV数据包
2. **网络活动**：目标网络的数据流量
3. **密钥长度**：64位比128位更容易破解
4. **攻击时间**：通常需要几分钟到几小时

### 成功率统计
- **64位WEP**：成功率 > 90%（收集5万IV）
- **128位WEP**：成功率 > 80%（收集10万IV）
- **152位WEP**：成功率 > 70%（收集15万IV）
- **256位WEP**：成功率 > 60%（收集20万IV）

## 注意事项

### 法律合规
- 仅在授权环境中使用
- 遵守当地法律法规
- 不得用于非法目的

### 技术限制
- 需要目标网络使用WEP加密
- 需要足够的网络数据流量
- 破解时间可能较长

### 最佳实践
- 在目标网络附近进行破解
- 使用去认证攻击增加流量
- 定期检查破解进度
- 及时导出破解结果

## 故障排除

### 常见问题
1. **无法收集IV**
   - 检查网络是否使用WEP加密
   - 确认监控模式是否启用
   - 验证网络活动情况

2. **破解失败**
   - 检查IV数量是否足够
   - 确认网络数据流量
   - 尝试不同的破解方法

3. **导出失败**
   - 检查UART连接
   - 确认数据格式正确
   - 验证缓冲区大小

### 调试方法
- 启用调试输出
- 检查串口日志
- 验证WEP数据包格式
- 监控内存使用

## 与现有功能集成

### 握手包捕获
- WEP破解与握手包捕获共享WiFi监控系统
- 可以同时进行多种攻击
- 统一的状态查询和导出接口

### 去认证攻击
- 可以结合去认证攻击强制重连
- 增加WEP数据包流量
- 提高破解成功率

## 扩展功能

### 未来改进
- 支持更多WEP变体
- 添加GPU加速破解
- 优化内存使用
- 增加实时破解显示

### 自定义开发
- 修改破解算法
- 添加新的攻击方法
- 集成第三方破解工具
- 开发自动化脚本

## 技术支持

如有问题或建议，请参考：
- 项目GitHub仓库
- 技术文档
- 社区论坛
- 开发者文档

## 相关工具

### 密码破解工具
- **aircrack-ng**: 传统WiFi破解工具
- **hashcat**: 支持WEP破解
- **John the Ripper**: 通用密码破解工具

### 数据格式转换
- 将WEP数据转换为aircrack-ng格式
- 支持多种导出格式
- 自动化脚本支持

## 历史背景

WEP是WiFi安全的最早标准，于1997年发布。由于其严重的安全漏洞，WEP在2003年被WPA取代，在2004年被WPA2取代。然而，许多老旧设备仍在使用WEP加密，这使得WEP破解仍然具有实际意义。

## 安全建议

对于网络管理员：
1. 立即升级所有WEP网络到WPA2或WPA3
2. 定期检查网络设备的安全配置
3. 监控网络中的异常活动
4. 使用强密码和定期更换密钥

对于用户：
1. 避免连接到WEP加密的网络
2. 使用VPN保护数据传输
3. 定期更新设备固件
4. 启用网络监控功能
